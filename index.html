<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drita, Teleskopët dhe Hëna Jonë e Mrekullueshme!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Marker Felt', sans-serif;
            background-color: #1a202c;
            color: #f7fafc;
        }
        .section {
            min-height: 100vh;
            padding: 4rem 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-bottom: 2px dashed #4a5568;
        }
        .fun-title {
            font-size: 3rem;
            font-weight: bold;
            color: #f6e05e;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        @media (min-width: 768px) {
            .fun-title {
                font-size: 5rem;
            }
        }
        .fun-button {
            background-color: #ed8936;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .fun-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.3);
        }
        .icon-nav {
            position: fixed;
            top: 50%;
            left: 1rem;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 1rem;
            background-color: rgba(45, 55, 72, 0.8);
            padding: 1rem;
            border-radius: 1.5rem;
            z-index: 50;
        }
        .icon-nav a {
            font-size: 2rem;
            transition: transform 0.2s;
        }
        .icon-nav a:hover {
            transform: scale(1.2);
        }
        .light-source-card {
            border: 4px solid #4a5568;
            transition: all 0.3s;
        }
        .light-source-card.active {
            border-color: #f6e05e;
            transform: scale(1.05);
            box-shadow: 0 0 20px #f6e05e;
        }
        .telescope-light-ray {
            position: absolute;
            background-color: #f6e05e;
            height: 4px;
            border-radius: 2px;
            transform-origin: left center;
            transition: width 1s ease-in-out, opacity 1s ease-in-out, transform 1s ease-in-out;
            opacity: 0;
            width: 0;
        }
        .lens { 
            background-color: #60a5fa;
            border-radius: 50%;
            opacity: 0.6;
            box-shadow: 0 0 10px #60a5fa;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .pulse-marker {
            animation: pulse 2s infinite;
            transition: opacity 0.5s ease-out;
        }
        .video-container {
            width: 100%;
            max-width: 640px;
            margin: 2rem auto;
            aspect-ratio: 16 / 9;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        .video-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        #moon-map-container {
            overflow: hidden; 
        }
        #moon-map-image {
            transition: transform 1.5s ease-in-out, opacity 0.8s ease-in-out 0.3s;
            transform-origin: 55% 40%; 
        }
        #moon-map-image.zoomed-in {
            transform: scale(3); 
        }
        #sea-of-tranquility-detail {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%; 
            opacity: 0;
            transition: opacity 0.8s ease-in-out, transform 1.5s ease-in-out;
            transform-origin: 55% 40%; 
            transform: scale(1); 
            pointer-events: none; 
        }
        #sea-of-tranquility-detail.visible-zoomed {
            opacity: 1;
            transform: scale(3); 
        }
        .image-caption {
            margin-top: 0.75rem; 
            font-size: 1.125rem; 
            color: #cbd5e0; 
            font-weight: 600; 
        }
        .carousel-container {
            width: 100%;
            max-width: 1000px; 
            margin: 2rem auto;
            position: relative;
            overflow: hidden;
            padding: 1rem 0; 
        }
        .carousel-track {
            display: flex;
        }
        .carousel-slide {
            flex: 0 0 auto; 
            width: 400px; 
            margin-right: 1rem; 
            box-sizing: border-box;
        }
        .carousel-slide img {
            width: 100%;
            height: 250px; 
            object-fit: cover;
            border-radius: 0.75rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: block;
        }
        .carousel-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(237, 137, 54, 0.9); 
            color: white;
            border: none;
            padding: 0.5rem; 
            width: 2.5rem; 
            height: 2.5rem; 
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.25rem;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            opacity: 0; 
            transition: opacity 0.3s ease-in-out;
        }
        .carousel-container:hover .carousel-button {
            opacity: 1; 
        }
        .carousel-button.prev {
            left: -10px; 
        }
        .carousel-button.next {
            right: -10px; 
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <nav class="icon-nav hidden md:flex">
        <a href="#intro" title="Hyrja">🌟</a>
        <a href="#light" title="Drita">💡</a>
        <a href="#telescope" title="Teleskopi">🔭</a>
        <a href="#moon" title="Hëna">🌙</a>
        <a href="#apollo" title="Apollo 11">🚀</a>
        <a href="#noar-adventures" title="Aventurat e Noarit">🖼️</a>
    </nav>

    <main>
        <section id="intro" class="section bg-gray-900">
            <h1 class="fun-title mb-4">Drita, Teleskopët,</h1>
            <h1 class="fun-title mb-8">dhe Hëna Jonë e Mrekullueshme!</h1>
            <p class="text-2xl text-gray-300 mb-4">Një projekt shkollor nga një astronaut i ardhshëm!</p>
            <p class="text-xl text-gray-400 mb-6">Noar Limani II-4</p>
            <a href="#light" class="fun-button text-2xl">Fillo Eksplorimin! 👇</a>
        </section>

        <section id="light" class="section">
            <h2 class="fun-title mb-4">Çfarë është Drita?</h2>
            <p class="max-w-2xl text-xl md:text-2xl text-gray-300 mb-8">Drita na ndihmon të shohim gjithçka! Ajo vjen nga gjërat e ndritshme dhe udhëton super shpejt. Kliko mbi figura për të mësuar më shumë!</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-4xl">
                <div class="light-source-card bg-gray-800 p-6 rounded-2xl cursor-pointer" onclick="toggleLightSource(this, 'sun')">
                    <div class="text-6xl mb-4">☀️</div>
                    <h3 class="text-2xl font-bold text-yellow-300">Dielli</h3>
                </div>
                <div class="light-source-card bg-gray-800 p-6 rounded-2xl cursor-pointer" onclick="toggleLightSource(this, 'lamp')">
                    <div class="text-6xl mb-4">💡</div>
                    <h3 class="text-2xl font-bold text-blue-300">Një Llampë</h3>
                </div>
                 <div class="light-source-card bg-gray-800 p-6 rounded-2xl cursor-pointer" onclick="toggleLightSource(this, 'firefly')">
                    <div class="text-6xl mb-4">🦟</div>
                    <h3 class="text-2xl font-bold text-green-300">Një Xixëllonjë</h3>
                </div>
                 <div class="light-source-card bg-gray-800 p-6 rounded-2xl cursor-pointer" onclick="toggleLightSource(this, 'flashlight')">
                    <div class="text-6xl mb-4">🔦</div>
                    <h3 class="text-2xl font-bold text-purple-300">Një Elektrik Dore</h3>
                </div>
            </div>
            <div id="light-fact" class="mt-8 text-2xl h-12 text-orange-400 font-bold"></div>
        </section>

        <section id="telescope" class="section">
            <h2 class="fun-title mb-4">Sy Super të Fuqishëm!</h2>
            <p class="max-w-2xl text-xl md:text-2xl text-gray-300 mb-8">Teleskopët përdorin THJERRËZA për të përthyer dritën dhe për t'i bërë gjërat e largëta të duken më të mëdha. Shtyp butonin për të parë se si!</p>
            <div class="w-full max-w-3xl h-64 md:h-80 bg-gray-900 rounded-2xl flex items-center relative overflow-hidden p-4 shadow-2xl">
                <div id="telescope-star-source" class="text-5xl md:text-6xl z-20 absolute left-4 md:left-8 top-1/2 -translate-y-1/2">⭐</div>
                
                <div id="objective-lens" class="lens w-5 md:w-6 h-32 md:h-40 left-[30%] md:left-[35%] z-10"></div>
                <div id="eyepiece-lens" class="lens w-3 md:w-4 h-20 md:h-24 left-[65%] md:left-[70%] z-10"></div>

                <div id="ray1_path" class="telescope-light-ray" style="top: calc(50% - 10px); left: 12%; md:left: 15%;"></div>
                <div id="ray2_path" class="telescope-light-ray" style="top: calc(50% + 6px); left: 12%; md:left: 15%;"></div>
                
                <div id="magnified-star" class="text-8xl md:text-9xl opacity-0 z-20 absolute right-4 md:right-8 top-1/2 -translate-y-1/2">⭐</div>
            </div>
            <button id="telescope-btn" class="fun-button mt-8">Shiko si funksionon!</button>
        </section>

        <section id="moon" class="section">
            <h2 class="fun-title mb-4">Hëna Jonë Misterioze</h2>
            <p class="max-w-2xl text-xl md:text-2xl text-gray-300 mb-8">A e ke vënë re që Hëna ndryshon formë? Këto quhen Faza! Nuk është magji, thjesht varet se si Dielli e ndriçon atë.</p>
            <div class="flex flex-col md:flex-row items-center justify-center gap-8 w-full max-w-5xl">
                <div class="relative w-64 h-64 md:w-80 md:h-80">
                    <div class="absolute inset-0 border-2 border-dashed border-gray-600 rounded-full"></div>
                    <div id="moon-earth" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-7xl md:text-8xl">🌍</div>
                    <div id="moon-orbit" class="absolute inset-0 transition-transform duration-1000">
                        <div id="moon-object" class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 text-5xl md:text-6xl">🌓</div>
                    </div>
                    <div class="absolute -right-20 md:-right-32 top-1/2 -translate-y-1/2 text-7xl md:text-8xl">☀️</div>
                </div>
                <div class="text-center">
                    <h3 class="text-3xl font-bold text-yellow-300 mb-4">Çfarë shohim nga Toka:</h3>
                    <div id="moon-phase-display" class="text-9xl mb-4">🌓</div>
                    <p id="moon-phase-name" class="text-2xl text-gray-300 font-bold mb-6">Çereku i Parë</p>
                    <button id="phase-btn" class="fun-button">Faza Tjetër</button>
                </div>
            </div>
        </section>

        <section id="apollo" class="section">
            <h2 class="fun-title mb-4">Një Hap Gjigant!</h2>
            <p class="max-w-3xl text-xl md:text-2xl text-gray-300 mb-8">A e dije që njerëzit kanë ECUR në Hënë? Misioni Apollo 11 ishte hera e parë që njerëzit vizituan një botë tjetër.</p>
            
            <div class="video-container">
                <iframe src="https://www.youtube.com/embed/wFh2j2pE_dI" title="Apollo 11 Launch - Original NASA Footage" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            
            <p class="max-w-3xl text-xl md:text-2xl text-gray-300 mt-8 mb-8">Kliko shenjën në hartën e Hënës më poshtë për të parë ku u ulën!</p>

            <div class="w-full max-w-lg text-center">
                <div id="moon-map-container" class="aspect-square rounded-full bg-gray-700 relative cursor-pointer mx-auto">
                     <img id="moon-map-image" src="https://images.pexels.com/photos/47367/full-moon-moon-bright-sky-47367.jpeg"
                          class="w-full h-full rounded-full object-cover"
                          onerror="this.onerror=null; this.src='https://placehold.co/800x800/cccccc/ffffff?text=Harta+Alternative';"
                          alt="Harta e Hënës që tregon zonën e uljes së Apollo 11"/>
                     <img id="sea-of-tranquility-detail" src="https://media.invisioncic.com/g327141/monthly_2018_06/347888625_SabineandRittertheAragoDomesandtheApollo11landingsite.png.be53dcfecf5462798ad2c7b13457e0f9.png"
                          class="w-full h-full rounded-full object-cover"
                          onerror="this.onerror=null; this.src='https://placehold.co/800x800/777777/ffffff?text=Detaj+Alternative';"
                          alt="Pamje e zmadhuar e Detit të Qetësisë"/>
                    <div id="tranquility-marker-container" class="absolute top-[40%] left-[55%] transform -translate-x-1/2 -translate-y-1/2 cursor-pointer" onclick="zoomToTranquility()">
                        <div class="pulse-marker w-10 h-10 rounded-full border-4 border-yellow-300 bg-yellow-300/50 flex items-center justify-center">
                            <div class="w-2 h-2 rounded-full bg-yellow-100"></div>
                        </div>
                    </div>
                </div>
                <p id="moon-map-caption" class="image-caption">Harta e Hënës</p>
            </div>
        </section>

        <section id="landing-site" class="section bg-gray-800">
             <h2 class="fun-title mb-4">Deti i Qetësisë</h2>
             <p class="max-w-2xl text-xl md:text-2xl text-gray-300 mb-8">Këtu u ulën ata! Mblodhën gurë hëne, bënë eksperimente dhe lanë gjurmët e para të këmbëve në Hënë.</p>
             <div class="w-full max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-8">
                 <div class="bg-gray-700 p-4 rounded-2xl">
                    <img src="https://scx1.b-cdn.net/csz/news/800a/2020/apollomoon.jpg" class="w-full h-auto rounded-lg object-cover aspect-[3/2]" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=Imazhi+i+Misionit+Apollo';" alt="Misioni Apollo 11 në Hënë">
                    <p class="mt-4 font-bold text-xl">Një hap i vogël për njeriun...</p>
                 </div>
                 <div class="bg-gray-700 p-4 rounded-2xl">
                    <img src="https://nssdc.gsfc.nasa.gov/imgcat/higher_res/apollo/as11_40_5878.jpg" class="w-full h-auto rounded-lg object-cover aspect-[3/2]" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=Imazhi+i+Gjurmës';" alt="Gjurmë këmbe në Hënë">
                     <p class="mt-4 font-bold text-xl">...një hap gjigant për njerëzimin!</p>
                 </div>
             </div>
        </section>
        
        <section id="noar-adventures" class="section bg-gray-900">
            <h2 class="fun-title mb-8">Aventurat e Noarit në Hapësirë!</h2>
            <p class="max-w-2xl text-xl md:text-2xl text-gray-300 mb-8">Shikoni disa nga fotot e mrekullueshme të Noarit duke eksploruar me teleskopin e tij dhe fotot që ka bërë!</p>
            <div class="carousel-container">
                <div class="carousel-track">
                    </div>
                <button class="carousel-button prev" onclick="manualCarouselChange(-1)">❮</button>
                <button class="carousel-button next" onclick="manualCarouselChange(1)">❯</button>
            </div>
        </section>

        <footer class="text-center p-8 bg-gray-900 border-t-0"> 
            <h2 class="fun-title text-4xl mb-4">Faleminderit që Eksploruat! 🚀</h2>
        </footer>
    </main>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetElement = document.querySelector(this.getAttribute('href'));
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });

            const telescopeBtn = document.getElementById('telescope-btn');
            if (telescopeBtn) {
                telescopeBtn.addEventListener('click', animateTelescope);
            }

            const phaseBtn = document.getElementById('phase-btn');
            if (phaseBtn) {
                phaseBtn.addEventListener('click', handleNextMoonPhase);
            }
            
            updateMoonPhaseDisplay(); 
            initializeCarousel();
        });
        
        const lightFacts = {
            sun: "Dielli është një yll gjigant! Drita e tij merr 8 minuta për të arritur tek ne.",
            lamp: "Llampat përdorin energji elektrike për të bërë dritë që të mund të lexojmë natën.",
            firefly: "Xixëllonjat bëjnë dritën e tyre. Quhet biolumineshencë!",
            flashlight: "Elektrikët e dorës përdorin bateri për të bërë një rreze drite që mund ta drejtojmë."
        };
        
        function toggleLightSource(element, source) {
            document.querySelectorAll('.light-source-card').forEach(card => card.classList.remove('active'));
            if (element) {
                element.classList.add('active');
            }
            const factEl = document.getElementById('light-fact');
            if (factEl) {
                factEl.textContent = lightFacts[source] || "";
            }
        }

        function animateTelescope() { 
            const ray1 = document.getElementById('ray1_path');
            const ray2 = document.getElementById('ray2_path');
            const magnifiedStar = document.getElementById('magnified-star');

            if (!ray1 || !ray2 || !magnifiedStar) {
                console.error("Elementë të animacionit të teleskopit mungojnë!");
                return;
            }

            ray1.style.transition = 'none';
            ray2.style.transition = 'none';
            magnifiedStar.style.opacity = '0';
            magnifiedStar.style.transform = 'scale(1) translateY(-50%)'; 
            
            ray1.style.width = '0';
            ray1.style.opacity = '0';
            ray1.style.transform = 'rotate(0deg)';
            
            ray2.style.width = '0';
            ray2.style.opacity = '0';
            ray2.style.transform = 'rotate(0deg)';

            void ray1.offsetWidth; 
            void ray2.offsetWidth; 

            const widthToObjective = '20%'; 
            setTimeout(() => {
                ray1.style.transition = 'width 0.7s ease-in-out, opacity 0.7s ease-in-out';
                ray2.style.transition = 'width 0.7s ease-in-out, opacity 0.7s ease-in-out';
                ray1.style.opacity = '1';
                ray2.style.opacity = '1';
                ray1.style.width = widthToObjective; 
                ray2.style.width = widthToObjective;
            }, 100);

            const widthToEyepieceFocal = '53%';
            const convergenceAngle = '6deg'; 

            setTimeout(() => {
                ray1.style.transition = 'width 1s ease-in-out, transform 1s ease-in-out, opacity 0.5s 0.5s ease-out';
                ray2.style.transition = 'width 1s ease-in-out, transform 1s ease-in-out, opacity 0.5s 0.5s ease-out';
                ray1.style.transform = `rotate(${convergenceAngle})`; 
                ray2.style.transform = `rotate(-${convergenceAngle})`; 
                ray1.style.width = widthToEyepieceFocal; 
                ray2.style.width = widthToEyepieceFocal;
            }, 800); 

            setTimeout(() => {
                magnifiedStar.style.transition = 'opacity 0.5s ease-in-out, transform 0.5s ease-in-out';
                magnifiedStar.style.opacity = '1';
                magnifiedStar.style.transform = 'scale(2.0) translateY(-50%)'; 
                ray1.style.opacity = '0.1'; 
                ray2.style.opacity = '0.1';
            }, 1800); 
        }

        let moonPhaseIndex = 0; 
        const moonPhasesData = [
            { emoji: '🌓', name: 'Çereku i Parë', angle: 0 },      
            { emoji: '🌔', name: 'Gunga Rritëse', angle: 45 },
            { emoji: '🌕', name: 'Hëna e Plotë', angle: 90 },
            { emoji: '🌖', name: 'Gunga Zbritëse', angle: 135 },
            { emoji: '🌗', name: 'Çereku i Fundit', angle: 180 }, 
            { emoji: '🌘', name: 'Draperi Zbritës', angle: 225 },
            { emoji: '🌑', name: 'Hëna e Re', angle: 270 },
            { emoji: '🌒', name: 'Draperi Rritës', angle: 315 }
        ];
        
        let currentVisualOrbitAngle = moonPhasesData[moonPhaseIndex].angle;

        function updateMoonPhaseDisplay() {
            const phase = moonPhasesData[moonPhaseIndex];
            const moonPhaseDisplayEl = document.getElementById('moon-phase-display');
            const moonPhaseNameEl = document.getElementById('moon-phase-name');
            const moonObjectEl = document.getElementById('moon-object');

            if (moonPhaseDisplayEl) moonPhaseDisplayEl.textContent = phase.emoji;
            if (moonPhaseNameEl) moonPhaseNameEl.textContent = phase.name;
            if (moonObjectEl) moonObjectEl.textContent = phase.emoji; 
            
            const moonOrbitEl = document.getElementById('moon-orbit');
            if (moonOrbitEl) moonOrbitEl.style.transform = `rotate(${currentVisualOrbitAngle}deg)`;
        }

        function handleNextMoonPhase() {
            const previousCanonicalAngle = moonPhasesData[moonPhaseIndex].angle;
            moonPhaseIndex = (moonPhaseIndex + 1) % moonPhasesData.length;
            const nextCanonicalAngle = moonPhasesData[moonPhaseIndex].angle;

            let angleDifference;
            if (nextCanonicalAngle < previousCanonicalAngle) { 
                angleDifference = (360 - previousCanonicalAngle) + nextCanonicalAngle;
            } else {
                angleDifference = nextCanonicalAngle - previousCanonicalAngle;
            }
            currentVisualOrbitAngle += angleDifference;

            updateMoonPhaseDisplay();
        }

        function zoomToTranquility() {
            const moonMapImage = document.getElementById('moon-map-image');
            const detailImage = document.getElementById('sea-of-tranquility-detail');
            const markerContainer = document.getElementById('tranquility-marker-container');
            const landingSiteSection = document.getElementById('landing-site');
            const captionElement = document.getElementById('moon-map-caption');

            if (moonMapImage && detailImage && markerContainer && landingSiteSection && captionElement) {
                const originX = '55%'; 
                const originY = '40%';
                moonMapImage.style.transformOrigin = `${originX} ${originY}`;
                detailImage.style.transformOrigin = `${originX} ${originY}`;
                
                moonMapImage.classList.add('zoomed-in');
                markerContainer.style.opacity = '0';
                if(captionElement) captionElement.textContent = 'Deti i Qetësisë (Pamje e Zmadhuar)';


                setTimeout(() => {
                    moonMapImage.style.opacity = '0';
                    detailImage.classList.add('visible-zoomed');
                }, 300); 

                setTimeout(() => {
                    landingSiteSection.scrollIntoView({ behavior: 'smooth' });
                }, 2500); 

                setTimeout(() => {
                    moonMapImage.classList.remove('zoomed-in');
                    moonMapImage.style.opacity = '1';
                    detailImage.classList.remove('visible-zoomed');
                    markerContainer.style.opacity = '1';
                    if(captionElement) captionElement.textContent = 'Harta e Hënës';
                }, 4000); 
            }
        }

        const carouselTrack = document.querySelector('.carousel-track');
        const carouselContainer = document.querySelector('.carousel-container');
        const placeholderImageSources = [
            "images/noari_telescope1.webp",
            "images/noari_telescope2.webp",
            "images/noari_hena.webp",
            "images/noari_telescope3.webp",
            "images/noari_space.webp" // Using 5 images as per previous setup
        ];
        const slideWidth = 400; 
        const slideMargin = 16; 
        const totalSlideWidth = slideWidth + slideMargin;
        let currentTrackPosition = 0;
        let scrollSpeed = 0.5; 
        let isCarouselPaused = false;
        let carouselAnimFrameId;

        function populateCarousel() {
            if (!carouselTrack) return;
            carouselTrack.innerHTML = ''; 
            const allImages = [...placeholderImageSources, ...placeholderImageSources]; 
            allImages.forEach(src => {
                const slideDiv = document.createElement('div');
                slideDiv.classList.add('carousel-slide');
                const img = document.createElement('img');
                img.src = src;
                img.alt = "Imazh nga aventurat e Noarit"; 
                img.onerror = function() { this.onerror=null; this.src='https://placehold.co/800x500/777777/ffffff?text=Problem+me+Imazhin'; };
                slideDiv.appendChild(img);
                carouselTrack.appendChild(slideDiv);
            });
            carouselTrack.style.width = `${totalSlideWidth * allImages.length}px`;
        }

        function autoScrollCarousel() {
            if (!isCarouselPaused && carouselTrack) {
                currentTrackPosition -= scrollSpeed;
                if (currentTrackPosition <= -(totalSlideWidth * placeholderImageSources.length)) {
                    carouselTrack.style.transition = 'none'; 
                    currentTrackPosition += (totalSlideWidth * placeholderImageSources.length);
                    carouselTrack.style.transform = `translateX(${currentTrackPosition}px)`;
                    void carouselTrack.offsetWidth; 
                    carouselTrack.style.transition = ''; 
                } else {
                    carouselTrack.style.transform = `translateX(${currentTrackPosition}px)`;
                }
            }
            carouselAnimFrameId = requestAnimationFrame(autoScrollCarousel);
        }
        
        function manualCarouselChange(direction) {
            if (!carouselTrack) return;
            isCarouselPaused = true; 
            cancelAnimationFrame(carouselAnimFrameId);

            const numOriginalSlides = placeholderImageSources.length;
            let currentEffectiveIndex = Math.floor(Math.abs(currentTrackPosition) / totalSlideWidth);
            
            currentEffectiveIndex += direction;
            currentTrackPosition = -(currentEffectiveIndex * totalSlideWidth);

            const totalOriginalSetWidth = totalSlideWidth * numOriginalSlides;
            if (currentTrackPosition < -totalOriginalSetWidth) { 
                currentTrackPosition += totalOriginalSetWidth; 
            } else if (currentTrackPosition > 0) { 
                currentTrackPosition -= totalOriginalSetWidth; 
                if (currentTrackPosition === 0 && direction === -1) currentTrackPosition = -totalOriginalSetWidth + totalSlideWidth;
            }
            
            carouselTrack.style.transition = 'transform 0.5s ease-in-out'; 
            carouselTrack.style.transform = `translateX(${currentTrackPosition}px)`;
            
            setTimeout(() => {
                if (carouselTrack) carouselTrack.style.transition = 'none'; 
                if (carouselContainer && !carouselContainer.matches(':hover')) { 
                    isCarouselPaused = false;
                    autoScrollCarousel();
                }
            }, 500); 
        }

        function initializeCarousel() {
            populateCarousel();
            if (carouselContainer && carouselTrack) {
                carouselContainer.addEventListener('mouseenter', () => {
                    isCarouselPaused = true;
                    if (carouselAnimFrameId) cancelAnimationFrame(carouselAnimFrameId);
                });
                carouselContainer.addEventListener('mouseleave', () => {
                    isCarouselPaused = false;
                    if (carouselTrack) carouselTrack.style.transition = 'none'; 
                    autoScrollCarousel(); 
                });
                if (carouselTrack) carouselTrack.style.transition = 'none'; 
                autoScrollCarousel(); 
            }
        }
    </script>
</body>
</html>

